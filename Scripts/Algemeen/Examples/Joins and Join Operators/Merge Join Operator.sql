-- ===========================================
-- Demonstrates the semantics of Merge Joins
-- ===========================================

/****************************************
	Merge Joins require pre-sorted input !!!


	A:	1, 3, 3, 5, 6, 6, 6, 8, 11, 11		
		>
	B:	2, 3, 5, 6, 6, 8, 10, 11
		------------------------>

	A:	1, 3, 3, 5, 6, 6, 6, 8, 11, 11			
		--->
	B:	2, 3, 5, 6, 6, 8, 10, 11
		--->-------------------->			3


	A:	1, 3, 3, 5, 6, 6, 6, 8, 11, 11				
		--------->
	B:	2, 3, 5, 6, 6, 8, 10, 11
		------>----------------->			5

	A:	1, 3, 3, 5, 6, 6, 6, 8, 11, 11		
		------------>		
	B:	2, 3, 5, 6, 6, 8, 10, 11
		--------->-->----------->			6, 6
		

	A:	1, 3, 3, 5, 6, 6, 6, 8, 11, 11		
		--------------------->		
	B:	2, 3, 5, 6, 6, 8, 10, 11
		--------------->-------->			8

	A:	1, 3, 3, 5, 6, 6, 6, 8, 11, 11		
		------------------------>		
	B:	2, 3, 5, 6, 6, 8, 10, 11
		---------------------->				11
		

	Result: 3, 5, 6, 6, 8, 11
****************************************/

set statistics io on;

set statistics time on;

use TippingPoint;
go

select a.*, 
	   b.*
from Customers as a
	 inner join Customers as b on b.CustomerID = a.CustomerID option(merge join);
go